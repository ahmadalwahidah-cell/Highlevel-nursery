# โ ุฅุตูุงุญ ุนุฑุถ ุญุงูุฉ ุงููุนููุฉ ุงููุญุฐููุฉ ูุน ุชุงุฑูุฎ ุงูุญุฐู

## ๐ฏ ุงููุดุงูู ุงูุชู ุชู ุญููุง

### 1. โ ุงููุดููุฉ ุงูุฃููู: ุญุงูุฉ ุงููุนููุฉ ุงููุญุฐููุฉ ุชุธูุฑ "ูุดุทุฉ"
**ุงููุตู:** ุนูุฏ ุญุฐู "ูุนููุฉ ูข"ุ ูุงูุช ุชุธูุฑ ูู ุงูุชูุฑูุฑ ุงูุดุงูู ุจุญุงูุฉ "ูุดุทุฉ" โ

**ุงูุณุจุจ:** API ูุง ูุฑุฌุน ุญููู `deleted_at` ู `is_deleted`

**ุงูุญู:** ุฅุถุงูุฉ ูุฐู ุงูุญููู ูุงุณุชุฌุงุจุฉ API

### 2. โ ุงููุดููุฉ ุงูุซุงููุฉ: PDF ุบูุฑ ูุงูู
**ุงููุตู:** ุนูุฏ ุชุญููู ุงูุชูุฑูุฑ ูู PDFุ ูุง ุชุธูุฑ ุฌููุน ุงููุนููุงุช

**ุงูุณุจุจ:** `html2canvas` ูุง ููุชูุท ุงูุฌุฏูู ุงููุงูู ุจุณุจุจ:
- ููุช ุงูุชุธุงุฑ ูุตูุฑ (500ms)
- ุฅุนุฏุงุฏุงุช ุงูุชูุงุท ุบูุฑ ูุซุงููุฉ

**ุงูุญู:** ุชุญุณูู ุฅุนุฏุงุฏุงุช `html2canvas` ูุฒูุงุฏุฉ ููุช ุงูุงูุชุธุงุฑ

---

## ๐ง ุงูุชุนุฏููุงุช ุงูุชูููุฉ

### 1. ุฅุตูุงุญ API (`src/routes/api.tsx`)

#### ูุจู ุงูุฅุตูุงุญ โ
```typescript
return {
  id: teacher.id,
  name: teacher.name,
  phone: teacher.phone,
  workDays,
  attendanceDays,
  absentDays,
  avgCheckIn,
  avgCheckOut
}
```

#### ุจุนุฏ ุงูุฅุตูุงุญ โ
```typescript
return {
  id: teacher.id,
  name: teacher.name,
  phone: teacher.phone,
  deleted_at: teacher.deleted_at,      // โ ุฅุถุงูุฉ
  is_deleted: teacher.is_deleted,      // โ ุฅุถุงูุฉ
  workDays,
  attendanceDays,
  absentDays,
  avgCheckIn,
  avgCheckOut
}
```

### 2. ุชุญุณูู ุนุฑุถ ุงูุญุงูุฉ (`src/routes/admin.tsx`)

#### ูุจู ุงูุฅุตูุงุญ โ
```javascript
const statusBadge = teacher.is_deleted 
  ? '<span class="bg-red-100 text-red-600">ูุญุฐููุฉ</span>' 
  : '<span class="bg-green-100 text-green-600">ูุดุทุฉ</span>';
```

#### ุจุนุฏ ุงูุฅุตูุงุญ โ
```javascript
let statusBadge = '';
if (teacher.is_deleted && teacher.deleted_at) {
    const deletedDate = new Date(teacher.deleted_at);
    const dateStr = deletedDate.toLocaleDateString('ar-EG', { 
        year: 'numeric', 
        month: 'long', 
        day: 'numeric' 
    });
    statusBadge = `
        <span class="bg-red-100 text-red-600" title="ุชุงุฑูุฎ ุงูุญุฐู: ${dateStr}">
            ๐ด ูุญุฐููุฉ
            <br>
            <small class="text-[10px]">${dateStr}</small>
        </span>
    `;
} else {
    statusBadge = '<span class="bg-green-100 text-green-600">๐ข ูุดุทุฉ</span>';
}
```

### 3. ุชุญุณูู ุงูุชูุงุท PDF

#### ูุจู ุงูุฅุตูุงุญ โ
```javascript
await new Promise(resolve => setTimeout(resolve, 500)); // ููุช ูุตูุฑ

const canvas = await html2canvas(reportElement, {
    scale: 3,
    scrollY: -window.scrollY,
    scrollX: -window.scrollX,
    windowHeight: reportElement.scrollHeight,
    height: reportElement.scrollHeight
});
```

#### ุจุนุฏ ุงูุฅุตูุงุญ โ
```javascript
// Wait longer for full render
await new Promise(resolve => setTimeout(resolve, 1000)); // โฑ๏ธ 1 ุซุงููุฉ

// Scroll to top to ensure full capture
window.scrollTo(0, 0); // ๐ ุงูุงูุชูุงู ูุฃุนูู ุงูุตูุญุฉ

const canvas = await html2canvas(reportElement, {
    scale: 2,                    // ุฌูุฏุฉ ุฌูุฏุฉ (ุชูููู ูู 3 ูุชุญุณูู ุงูุชูุงูู)
    useCORS: true,
    allowTaint: true,
    backgroundColor: '#ffffff',
    scrollY: 0,                  // โ ุจุฏุงูุฉ ูู ุงูุฃุนูู
    scrollX: 0,
    windowHeight: document.documentElement.scrollHeight, // โ ุงุฑุชูุงุน ุงูุตูุญุฉ ุงููุงูู
    height: reportElement.scrollHeight,
    logging: false,
    imageTimeout: 0              // โ ุจุฏูู ุญุฏ ุฒููู ููุตูุฑ
});
```

---

## ๐ ุงููุชูุฌุฉ ุงูููุงุฆูุฉ

### โ ุนุฑุถ ุญุงูุฉ "ูุนููุฉ ูข" ูู ุงูุชูุฑูุฑ:

#### ูู ุงููููุน:
```
โโโโโโฌโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโฌโโโโโโโโโโโฌโโโโโโโโโโ
โ #  โ ุงูุงุณู    โ ุงูุญุงูุฉ               โ ุงููุงุชู   โ ...     โ
โโโโโโผโโโโโโโโโโโผโโโโโโโโโโโโโโโโโโโโโโผโโโโโโโโโโโผโโโโโโโโโโค
โ 8  โ ูุนููุฉ ูข  โ ๐ด ูุญุฐููุฉ           โ    -     โ ...     โ
โ    โ          โ ูค ุฏูุณูุจุฑ ูขููขูฅ       โ          โ         โ
โโโโโโดโโโโโโโโโโโดโโโโโโโโโโโโโโโโโโโโโโดโโโโโโโโโโโดโโโโโโโโโโ
```

**ูุน Tooltip ุนูุฏ ุงูุชูุฑูุฑ:** "ุชุงุฑูุฎ ุงูุญุฐู: 4 ุฏูุณูุจุฑ 2025"

#### ูู PDF:
โ ุฌููุน ุงููุนููุงุช ุชุธูุฑ ุจุดูู ูุงูู  
โ ุงูุญุงูุฉ ูุงุถุญุฉ ูุน ุชุงุฑูุฎ ุงูุญุฐู  
โ ุงูุชูุณููุงุช ูุงูุฃููุงู ูุญููุธุฉ

---

## ๐งช ุทุฑููุฉ ุงูุงุฎุชุจุงุฑ

### 1. ุงุฎุชุจุงุฑ ุนุฑุถ ุงูุญุงูุฉ:
```bash
# 1. ุชุณุฌูู ุงูุฏุฎูู ููุฏูุฑุฉ (1020)
# 2. ุงูุฐูุงุจ ุฅูู: /admin/nursery/teacher-attendance-report
# 3. ุงุฎุชูุงุฑ ุงูุณูุฉ: 2025
# 4. ุงุฎุชูุงุฑ ุงูุดูุฑ: ุฏูุณูุจุฑ
# 5. ุงูุถุบุท ุนูู "ุนุฑุถ ุงูุชูุฑูุฑ"

# ุงููุชูุฌุฉ ุงููุชููุนุฉ:
โ ูุนููุฉ ูข ุชุธูุฑ ูู ุงูุฌุฏูู
โ ุงูุญุงูุฉ: ๐ด ูุญุฐููุฉ
โ ุชุงุฑูุฎ ุงูุญุฐู: ูค ุฏูุณูุจุฑ ูขููขูฅ
โ ุฎูููุฉ ุงูุตู: ุญูุฑุงุก ูุงุชุญุฉ
```

### 2. ุงุฎุชุจุงุฑ PDF:
```bash
# 1. ุจุนุฏ ุนุฑุถ ุงูุชูุฑูุฑ
# 2. ุงูุถุบุท ุนูู ุฒุฑ "ุชุญููู PDF" ุงูุฃุฎุถุฑ
# 3. ุงูุชุธุงุฑ ุฑุณุงูุฉ "ุฌุงุฑู ุฅูุดุงุก ููู PDF..."
# 4. ุชุญููู ุงูููู

# ุงููุชูุฌุฉ ุงููุชููุนุฉ:
โ ุฌููุน ุงููุนููุงุช (8) ุชุธูุฑ ูู PDF
โ ูุนููุฉ ูข ุชุธูุฑ ูุน ุญุงูุฉ "ูุญุฐููุฉ" ูุชุงุฑูุฎ ุงูุญุฐู
โ ุฌููุน ุงูุชูุงุตูู ูุงุถุญุฉ ูููุฑูุกุฉ
```

### 3. ุงุฎุชุจุงุฑ API:
```bash
curl "https://highlevel-nursery.pages.dev/api/teacher-attendance-report?year=2025&month=12"
```

**ุงููุชูุฌุฉ ุงููุชููุนุฉ:**
```json
{
  "teachers": [
    ...
    {
      "id": 11,
      "name": "ูุนููุฉ ูข",
      "phone": null,
      "deleted_at": "2025-12-04 16:36:21",  โ
      "is_deleted": 1,                       โ
      "workDays": 23,
      "attendanceDays": 2,
      "absentDays": 21,
      "avgCheckIn": "20:08",
      "avgCheckOut": "15:20"
    }
  ]
}
```

---

## ๐จ ุงูุชูุงุตูู ุงูุจุตุฑูุฉ

### ุนุฑุถ ุงูุญุงูุฉ:

#### ูููุนููุฉ ุงููุดุทุฉ ๐ข
```
โโโโโโโโโโโโโโโโโโโ
โ ๐ข ูุดุทุฉ        โ
โโโโโโโโโโโโโโโโโโโ
ุฎูููุฉ: ุฃุฎุถุฑ ูุงุชุญ
ูุต: ุฃุฎุถุฑ ุฏุงูู
```

#### ูููุนููุฉ ุงููุญุฐููุฉ ๐ด
```
โโโโโโโโโโโโโโโโโโโโโโโ
โ ๐ด ูุญุฐููุฉ           โ
โ ูค ุฏูุณูุจุฑ ูขููขูฅ       โ
โโโโโโโโโโโโโโโโโโโโโโโ
ุฎูููุฉ: ุฃุญูุฑ ูุงุชุญ
ูุต: ุฃุญูุฑ ุฏุงูู
ุญุฌู ุงูุชุงุฑูุฎ: ุตุบูุฑ ุฌุฏุงู (10px)
```

### ุฎูููุฉ ุงูุตู:

| ุงูุญุงูุฉ | ุงูููู |
|--------|-------|
| ูุดุทุฉ (ุฒูุฌู) | ุฑูุงุฏู ูุงุชุญ (#f9fafb) |
| ูุดุทุฉ (ูุฑุฏู) | ุฃุจูุถ (#ffffff) |
| ูุญุฐููุฉ | ุฃุญูุฑ ูุงุชุญ + ุดูุงููุฉ (#fef2f2 + opacity: 0.75) |

---

## ๐ ุงูุจูุงูุงุช ุงููุนููุฉ

### ูุนููุฉ ูข ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช:
```sql
SELECT id, name, deleted_at, 
       CASE WHEN deleted_at IS NOT NULL THEN 1 ELSE 0 END as is_deleted
FROM teachers 
WHERE id = 11;
```

**ุงููุชูุฌุฉ:**
```
id: 11
name: ูุนููุฉ ูข
deleted_at: 2025-12-04 16:36:21
is_deleted: 1
```

### ุจูุงูุงุช ุงูุญุถูุฑ ุงููุญููุธุฉ:
```
workDays: 23
attendanceDays: 2
absentDays: 21
avgCheckIn: 20:08
avgCheckOut: 15:20
```

**ุงูุฎูุงุตุฉ:** โ ุฌููุน ุงูุจูุงูุงุช ูุญููุธุฉ ุญุชู ุจุนุฏ ุงูุญุฐู!

---

## ๐ ุงูุฑูุงุจุท ุงููููุฉ

| ุงูุตูุญุฉ | ุงูุฑุงุจุท |
|--------|--------|
| **ุงูุชูุฑูุฑ ุงูุดุงูู** | `https://highlevel-nursery.pages.dev/admin/nursery/teacher-attendance-report` |
| **API** | `https://highlevel-nursery.pages.dev/api/teacher-attendance-report?year=2025&month=12` |
| **ุขุฎุฑ ูุดุฑ** | `https://6e34075d.highlevel-nursery.pages.dev` |

---

## โจ ุงูููุงุฆุฏ

### 1. ูุถูุญ ุงูุญุงูุฉ:
- โ ุนุฑุถ ูุงุถุญ ูุญุงูุฉ ุงููุนููุฉ (ูุดุทุฉ/ูุญุฐููุฉ)
- โ ุชุงุฑูุฎ ุงูุญุฐู ูุฑุฆู ูุจุงุดุฑุฉ
- โ Tooltip ุฅุถุงูู ุนูุฏ ุงูุชูุฑูุฑ

### 2. ุงูุชูุงุฑูุฑ ุงูุฏูููุฉ:
- โ ุณูููุฉ ุงูุชูููุฒ ุจูู ุงููุนููุงุช ุงููุดุทุงุช ูุงููุญุฐููุงุช
- โ ูุนุฑูุฉ ูุชู ุชู ุงูุญุฐู ุจุงูุถุจุท
- โ ุชุชุจุน ุงูุจูุงูุงุช ุงูุชุงุฑูุฎูุฉ

### 3. PDF ูุงูู:
- โ ุฌููุน ุงููุนููุงุช ุชุธูุฑ
- โ ุฌูุฏุฉ ุนุงููุฉ ูุงุถุญุฉ
- โ ุชูุณููุงุช ูุญููุธุฉ

---

## ๐จ ููุงุญุธุงุช ูููุฏูุฑุฉ

### ุญุงูุฉ "ูุนููุฉ ูข" ุงูุขู:

#### ูู ุงูููุงุฆู ุงูุนุงุฏูุฉ:
- โ **ูุง ุชุธูุฑ** ูู ูุงุฆูุฉ "ุฅุฏุงุฑุฉ ุงููุนููุงุช"
- โ **ูุง ุชูุญุณุจ** ูู ุนุฏุฏ ุงููุนููุงุช ุงููุดุทุงุช
- โ **ูุง ุชุธูุฑ** ูู ููุญุฉ ุงูุชุญูู

#### ูู ุงูุชูุงุฑูุฑ ุงูุดุงููุฉ:
- โ **ุชุธูุฑ** ูู ุชูุฑูุฑ ุญุถูุฑ ุงููุนููุงุช
- โ **ูุน ุนูุงูุฉ:** ๐ด ูุญุฐููุฉ
- โ **ูุน ุชุงุฑูุฎ ุงูุญุฐู:** ูค ุฏูุณูุจุฑ ูขููขูฅ
- โ **ุฌููุน ุจูุงูุงุชูุง ูุญููุธุฉ:** ุญุถูุฑุ ุงูุตุฑุงูุ ุชุฃุฎูุฑ

### ุชุญููู PDF:
1. ุงุฎุชูุงุฑ ุงูุณูุฉ ูุงูุดูุฑ
2. ุงูุถุบุท ุนูู "ุนุฑุถ ุงูุชูุฑูุฑ" (ุฒุฑ ูุฑุฏู)
3. **ุงูุงูุชุธุงุฑ** ุญุชู ูุธูุฑ ุงูุฌุฏูู ูุงููุงู
4. ุงูุถุบุท ุนูู "ุชุญููู PDF" (ุฒุฑ ุฃุฎุถุฑ)
5. ุงูุงูุชุธุงุฑ 3-5 ุซูุงูู ูุฑุณุงูุฉ "ุฌุงุฑู ุฅูุดุงุก ููู PDF..."
6. โ ุณูุชู ุชุญููู PDF ูุงูู ุจุฌููุน ุงููุนููุงุช

---

## ๐ ููุงุฑูุฉ ูุจู/ุจุนุฏ

### ูุจู ุงูุฅุตูุงุญ โ

| ุงูุนูุตุฑ | ุงูุญุงูุฉ |
|--------|--------|
| ุญุงูุฉ ูุนููุฉ ูข | "ูุดุทุฉ" โ |
| ุชุงุฑูุฎ ุงูุญุฐู | ุบูุฑ ููุฌูุฏ โ |
| PDF | ูุงูุต (5 ูุนููุงุช ููุท) โ |
| API | ูุง ูุฑุฌุน `is_deleted` โ |

### ุจุนุฏ ุงูุฅุตูุงุญ โ

| ุงูุนูุตุฑ | ุงูุญุงูุฉ |
|--------|--------|
| ุญุงูุฉ ูุนููุฉ ูข | "๐ด ูุญุฐููุฉ" โ |
| ุชุงุฑูุฎ ุงูุญุฐู | "ูค ุฏูุณูุจุฑ ูขููขูฅ" โ |
| PDF | ูุงูู (8 ูุนููุงุช) โ |
| API | ูุฑุฌุน ูู ุงูุจูุงูุงุช โ |

---

## ๐ ุงูุฎูุงุตุฉ

### ุงููุดุงูู ุงูุฃุตููุฉ:
1. โ "ุญุงูุฉ ูุนููุฉ ูข ุชุธูุฑ ูุดุทุฉ ุนูู ุงูุฑุบู ูู ุญุฐููุง"
2. โ "PDF ุบูุฑ ูุงูู - ูุง ูุธูุฑ ุฌููุน ุงููุนููุงุช"

### ุงูุญููู ุงููุทุจูุฉ:
1. โ ุฅุถุงูุฉ `deleted_at` ู `is_deleted` ูุงุณุชุฌุงุจุฉ API
2. โ ุนุฑุถ ุงูุญุงูุฉ ุงูุตุญูุญุฉ ูุน ุชุงุฑูุฎ ุงูุญุฐู
3. โ ุชุญุณูู ุงูุชูุงุท PDF ููุญุตูู ุนูู ูุญุชูู ูุงูู

### ุงููุชูุฌุฉ ุงูููุงุฆูุฉ:
๐ฏ **ูุนููุฉ ูข ุงูุขู ุชุธูุฑ ูู "ูุญุฐููุฉ" ูุน ุชุงุฑูุฎ ุงูุญุฐูุ ูุงูู PDF ูุญุชูู ุนูู ุฌููุน ุงููุนููุงุช ุจุดูู ูุงูู!**

---

**ุชุงุฑูุฎ ุงูุฅุตูุงุญ:** 4 ุฏูุณูุจุฑ 2025  
**ุขุฎุฑ ูุดุฑ:** `https://6e34075d.highlevel-nursery.pages.dev`  
**ุงูุญุงูุฉ:** ๐ข **ููุชูู 100% ูุฌุงูุฒ ููุงุณุชุฎุฏุงู**
